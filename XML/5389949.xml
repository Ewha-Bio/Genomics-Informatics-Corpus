<?xml version="1.0" ?>
<!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd">
<pmc-articleset><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article">
  <?properties open_access?>
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">Genomics Inform</journal-id>
      <journal-id journal-id-type="iso-abbrev">Genomics Inform</journal-id>
      <journal-id journal-id-type="publisher-id">GNI</journal-id>
      <journal-title-group>
        <journal-title>Genomics &amp; Informatics</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1598-866X</issn>
      <issn pub-type="epub">2234-0742</issn>
      <publisher>
        <publisher-name>Korea Genome Organization</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmid">28416950</article-id>
      <article-id pub-id-type="pmc">5389949</article-id>
      <article-id pub-id-type="doi">10.5808/GI.2017.15.1.51</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Application Note</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>TRAPR: R Package for Statistical Analysis and Visualization of RNA-Seq Data</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Lim</surname>
            <given-names>Jae Hyun</given-names>
          </name>
          <xref ref-type="aff" rid="A1"/>
          <xref ref-type="author-notes" rid="FN1">&#xA7;</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>Soo Youn</given-names>
          </name>
          <xref ref-type="aff" rid="A1"/>
          <xref ref-type="author-notes" rid="FN1">&#xA7;</xref>
        </contrib>
        <contrib contrib-type="author" corresp="yes">
          <name>
            <surname>Kim</surname>
            <given-names>Ju Han</given-names>
          </name>
          <xref ref-type="aff" rid="A1"/>
        </contrib>
      </contrib-group>
      <aff id="A1">Seoul National University Biomedical Informatics (SNUBI), Division of Biomedical Informatics and Systems Biomedical Informatics Research Center, Seoul National University College of Medicine, Seoul 110799, Korea.</aff>
      <author-notes>
        <corresp>Corresponding author: Tel: +82-2-740-8320, Fax: +82-2-747-8928, <email>Juhan@snu.ac.kr</email></corresp>
        <fn id="FN1" fn-type="equal">
          <p><sup>&#xA7;</sup>These authors contributed equally to this work.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="ppub">
        <month>3</month>
        <year>2017</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>29</day>
        <month>3</month>
        <year>2017</year>
      </pub-date>
      <volume>15</volume>
      <issue>1</issue>
      <fpage>51</fpage>
      <lpage>53</lpage>
      <history>
        <date date-type="received">
          <day>23</day>
          <month>1</month>
          <year>2017</year>
        </date>
        <date date-type="rev-recd">
          <day>07</day>
          <month>2</month>
          <year>2017</year>
        </date>
        <date date-type="accepted">
          <day>15</day>
          <month>2</month>
          <year>2017</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>Copyright &#xA9; 2017 by the Korea Genome Organization</copyright-statement>
        <copyright-year>2017</copyright-year>
        <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
          <license-p>It is identical to the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>).</license-p>
        </license>
      </permissions>
      <abstract>
        <p>High-throughput transcriptome sequencing, also known as RNA sequencing (RNA-Seq), is a standard technology for measuring gene expression with unprecedented accuracy. Numerous bioconductor packages have been developed for the statistical analysis of RNA-Seq data. However, these tools focus on specific aspects of the data analysis pipeline, and are difficult to appropriately integrate with one another due to their disparate data structures and processing methods. They also lack visualization methods to confirm the integrity of the data and the process. In this paper, we propose an R-based RNA-Seq analysis pipeline called TRAPR, an integrated tool that facilitates the statistical analysis and visualization of RNA-Seq expression data. TRAPR provides various functions for data management, the filtering of low-quality data, normalization, transformation, statistical analysis, data visualization, and result visualization that allow researchers to build customized analysis pipelines.</p>
      </abstract>
      <kwd-group>
        <kwd>base sequence</kwd>
        <kwd>gene expression profiling</kwd>
        <kwd>molecular sequence data</kwd>
        <kwd>programming languages</kwd>
        <kwd>sequence analysis/RNA</kwd>
        <kwd>software</kwd>
      </kwd-group>
      <funding-group>
        <award-group>
          <funding-source country="KR">
            <institution-wrap>
              <institution>National Research Foundation of Korea</institution>
              <institution-id institution-id-type="CrossRef">http://dx.doi.org/10.13039/501100003725</institution-id>
            </institution-wrap>
          </funding-source>
          <award-id>2012-0000994</award-id>
        </award-group>
        <award-group>
          <funding-source country="KR">
            <institution-wrap>
              <institution>Ministry of Health and Welfare</institution>
              <institution-id institution-id-type="CrossRef">http://dx.doi.org/10.13039/501100003625</institution-id>
            </institution-wrap>
          </funding-source>
          <award-id>HI13C2164</award-id>
        </award-group>
        <award-group>
          <funding-source country="KR">
            <institution-wrap>
              <institution>Ministry of Food and Drug Safety</institution>
              <institution-id institution-id-type="CrossRef">http://dx.doi.org/10.13039/501100003569</institution-id>
            </institution-wrap>
          </funding-source>
          <award-id>16183-MFDS541</award-id>
        </award-group>
      </funding-group>
    </article-meta>
  </front>
  <body>
    <sec sec-type="intro">
      <title>Introduction</title>
      <p>High-throughput mRNA sequencing technology has developed at great pace in recent years [<xref rid="B1" ref-type="bibr">1</xref>]. Data from RNA sequencing (RNA-Seq) experiments across many species and tissue types are available for free access through public repositories. While RNA-Seq data have a wide range of applications, such as alternative splicing research, fusion gene finding, novel transcript discovery, etc., the most important and widely considered application is the quantification of gene expression profiles and the assessment of differentially expressed genes (DEGs) [<xref rid="B2" ref-type="bibr">2</xref>].</p>
      <p>Evaluating differential expression in conditions by RNA-Seq is a multi-step process [<xref rid="B3" ref-type="bibr">3</xref>]. R/bioconductor [<xref rid="B4" ref-type="bibr">4</xref>] has been used to develop tools for the statistical analysis of RNA-Seq data. Some packages stem from classical methods for microarray data analysis, like the t test. Others, like edgeR [<xref rid="B5" ref-type="bibr">5</xref>], DESeq [<xref rid="B6" ref-type="bibr">6</xref>], DEGSeq [<xref rid="B7" ref-type="bibr">7</xref>], and baySeq [<xref rid="B8" ref-type="bibr">8</xref>], have recently been developed to the characteristics of RNA-Seq data. However, different packages partially support varying steps of the multi-step process in a very inconsistent manner. Moreover, no R packages support data filtering steps to improve the statistical power and control outliers that might have an undesirable influence on further analysis [<xref rid="B9" ref-type="bibr">9</xref>].</p>
      <p>This study proposes TRAPR (Total RNA-Seq Analysis Package for R, <ext-link ext-link-type="uri" xlink:href="http://www.snubi.org/software/trapr">http://www.snubi.org/software/trapr</ext-link>), an integrated pipeline for the analysis of RNA-Seq gene expression data. TRAPR uses gene expression tables to perform all RNA-Seq analyses, including data preprocessing, filtering, normalization, and statistical tests. TRAPR also provides visualization functions for data exploration and results' summarization. TRAPR provides a unique way of combining state-of-the-art analysis methods in an integrated pipeline for comprehensive RNA-Seq data analysis. For instance, upper-quartile normalization followed by zero-value filtering, variance stabilizing normalization (VSN) [<xref rid="B10" ref-type="bibr">10</xref>], and edgeR statistical testing with proper data visualization can easily be streamlined. These combinations have considerable potential to improve the accuracy and statistical power [<xref rid="B11" ref-type="bibr">11</xref>] of the analysis of RNA-Seq gene expression data.</p>
    </sec>
    <sec sec-type="results">
      <title>Results</title>
      <p><xref ref-type="fig" rid="F1">Fig. 1</xref> shows the five steps of TRAPR, i.e., data manipulation, data preprocessing, statistical analysis, preprocessing result visualization, and statistical result visualization.</p>
      <sec>
        <title>Data manipulation</title>
        <p>TRAPR provides two functions to import RNA-Seq experimental data and four functions to export results to files. TRAPR can read text files for expression data as well as for a list of genes. During or following analysis, users can export DEG lists or detailed tables for DEG and expression tables, which other tools can utilize.</p>
      </sec>
      <sec>
        <title>Data preprocessing</title>
        <p>TRAPR provides three types of data preprocessing methods: filtering, transformation, and normalization. TRAPR filtering has six filter types: sample, gene, zero value, low variance, low expression, and gene list. Unlike DNA microarrays that have a fixed number of probes, RNA-Seq explores massive amounts of isoforms and novel transcripts mixed with noise, such that it returns many zeros and nonsense values. Genes encoding miRNAs or snoRNAs often show extremely high expression levels, even though they are treated by a poly-A purification procedure. These outliers can easily be removed by zero-value and gene filters. Statistical power can be improved by low-expression and low-variance filters by reducing non-standard distributions. Analyzing different combinations of samples can conveniently be supported by sample filtering.</p>
        <p>TRAPR provides two well-known transformation functions, log2 transformation and VSN, followed by hyperbolic arcsin, arcsin(x), and transformation [<xref rid="B11" ref-type="bibr">11</xref>] to standardize data distribution and normalize variance distribution, respectively.</p>
        <p>TRAPR provides many normalization methods, including upper quantile [<xref rid="B12" ref-type="bibr">12</xref>], quantile, mean, and median normalizations. One can conveniently compare the effect of applying different methods with the following statistical testing and visualization functions.</p>
      </sec>
      <sec>
        <title>Statistical testing</title>
        <p>TRAPR has several statistical testing functions to identify DEGs. Student t-test and statistical methods suggested in edgeR, baySeq, and DESeq assume a normal distribution or a Poisson distribution. Meanwhile, methods in DEGseq and NOISeq [<xref rid="B12" ref-type="bibr">12</xref>] do not need to make any assumption. For now, there is no correct answer that fits the characteristics of RNA-Seq data, and each method has its own merits. TRAPR allows users to choose their own methods to build customized analysis pipelines. The t test is recommended for large datasets, whereas edgeR and simple-fold change work for datasets with a small number of samples. DEGs can be labeled and saved as files containing lists of gene names with detailed information.</p>
      </sec>
      <sec>
        <title>Visualization</title>
        <p>Data preprocessing steps are not supported by visualization functions in previously developed packages, while proper visualization is essential and powerful for evaluating the quality of the RNA-Seq data and the preprocessing steps. TRAPR provides five flexible plotting functions, including density, boxplot, MA, scatter, and mean&#x2013;variance plots. Volcano plots and heatmaps are also provided to visualize the results of statistical analysis. Each visualization function has direct access to FPKM values and differential expression values.</p>
      </sec>
    </sec>
    <sec sec-type="discussion">
      <title>Discussion</title>
      <p>We have developed TRAPR, an R package for RNA-Seq data analysis. TRAPR provides an entire pipeline for RNA-Seq analysis, which is not merely a combination of currently available tools, but the backbone that facilitates the proper application and coordination of these tools. For instance, upper-quartile normalization followed by zero-value filtering, VSN, and edgeR statistical testing with proper data visualization can easily be streamlined through TRAPR. These combinations will help improve accuracy and statistical power. TRAPR provides visualization tools and file I/O functions to evaluate the quality and characteristics of the data. TRAPR was developed and integrated in R, such that it can be easily applied to other technologies like Serial Analysis of Gene Expression and microarray. Various filters have been integrated into the package. TRAPR can be used as a platform to interweave RNA-Seq data analysis tools and packages to take advantage of the virtues of each.</p>
    </sec>
  </body>
  <back>
    <ack>
      <title>Acknowledgments</title>
      <p>This work was supported by a National Research Foundation of Korea (NRF) grant funded by the Korean government (MSIP) (2012-0000994), the Korean Health Technology R&amp;D Project, the Ministry of Health and Welfare (HI13C2164), and the ICT R&amp;D program of MSIP/IITP [B0101-15-247 for the &#x201C;Development of Open ICT Healing Platform Using Personal Health Data&#x201D;], a grant (16183-MFDS541) from Ministry of Food and Drug Safety in 2016.</p>
    </ack>
    <fn-group>
      <fn fn-type="other">
        <p><bold>Availability:</bold> TRAPR is written in R(the version 2.15), and is available at <ext-link ext-link-type="uri" xlink:href="http://www.snubi.org/software/trapr">http://www.snubi.org/software/trapr</ext-link>.</p>
      </fn>
    </fn-group>
    <ref-list>
      <ref id="B1">
        <label>1</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Wang</surname>
              <given-names>Z</given-names>
            </name>
            <name>
              <surname>Gerstein</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Snyder</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
          <source>Nat Rev Genet</source>
          <year>2009</year>
          <volume>10</volume>
          <fpage>57</fpage>
          <lpage>63</lpage>
          <pub-id pub-id-type="pmid">19015660</pub-id>
        </element-citation>
      </ref>
      <ref id="B2">
        <label>2</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Garber</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Grabherr</surname>
              <given-names>MG</given-names>
            </name>
            <name>
              <surname>Guttman</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Trapnell</surname>
              <given-names>C</given-names>
            </name>
          </person-group>
          <article-title>Computational methods for transcriptome annotation and quantification using RNA-seq</article-title>
          <source>Nat Methods</source>
          <year>2011</year>
          <volume>8</volume>
          <fpage>469</fpage>
          <lpage>477</lpage>
          <pub-id pub-id-type="pmid">21623353</pub-id>
        </element-citation>
      </ref>
      <ref id="B3">
        <label>3</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Auer</surname>
              <given-names>PL</given-names>
            </name>
            <name>
              <surname>Srivastava</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Doerge</surname>
              <given-names>RW</given-names>
            </name>
          </person-group>
          <article-title>Differential expression: the next generation and beyond</article-title>
          <source>Brief Funct Genomics</source>
          <year>2012</year>
          <volume>11</volume>
          <fpage>57</fpage>
          <lpage>62</lpage>
          <pub-id pub-id-type="pmid">22210853</pub-id>
        </element-citation>
      </ref>
      <ref id="B4">
        <label>4</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gentleman</surname>
              <given-names>RC</given-names>
            </name>
            <name>
              <surname>Carey</surname>
              <given-names>VJ</given-names>
            </name>
            <name>
              <surname>Bates</surname>
              <given-names>DM</given-names>
            </name>
            <name>
              <surname>Bolstad</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Dettling</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Dudoit</surname>
              <given-names>S</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
          <source>Genome Biol</source>
          <year>2004</year>
          <volume>5</volume>
          <fpage>R80</fpage>
          <pub-id pub-id-type="pmid">15461798</pub-id>
        </element-citation>
      </ref>
      <ref id="B5">
        <label>5</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Robinson</surname>
              <given-names>MD</given-names>
            </name>
            <name>
              <surname>McCarthy</surname>
              <given-names>DJ</given-names>
            </name>
            <name>
              <surname>Smyth</surname>
              <given-names>GK</given-names>
            </name>
          </person-group>
          <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
          <source>Bioinformatics</source>
          <year>2010</year>
          <volume>26</volume>
          <fpage>139</fpage>
          <lpage>140</lpage>
          <pub-id pub-id-type="pmid">19910308</pub-id>
        </element-citation>
      </ref>
      <ref id="B6">
        <label>6</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Anders</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Huber</surname>
              <given-names>W</given-names>
            </name>
          </person-group>
          <article-title>Differential expression analysis for sequence count data</article-title>
          <source>Genome Biol</source>
          <year>2010</year>
          <volume>11</volume>
          <fpage>R106</fpage>
          <pub-id pub-id-type="pmid">20979621</pub-id>
        </element-citation>
      </ref>
      <ref id="B7">
        <label>7</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Wang</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Feng</surname>
              <given-names>Z</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Zhang</surname>
              <given-names>X</given-names>
            </name>
          </person-group>
          <article-title>DEGseq: an R package for identifying differentially expressed genes from RNA-seq data</article-title>
          <source>Bioinformatics</source>
          <year>2010</year>
          <volume>26</volume>
          <fpage>136</fpage>
          <lpage>138</lpage>
          <pub-id pub-id-type="pmid">19855105</pub-id>
        </element-citation>
      </ref>
      <ref id="B8">
        <label>8</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Hardcastle</surname>
              <given-names>TJ</given-names>
            </name>
            <name>
              <surname>Kelly</surname>
              <given-names>KA</given-names>
            </name>
          </person-group>
          <article-title>baySeq: empirical Bayesian methods for identifying differential expression in sequence count data</article-title>
          <source>BMC Bioinformatics</source>
          <year>2010</year>
          <volume>11</volume>
          <fpage>422</fpage>
          <pub-id pub-id-type="pmid">20698981</pub-id>
        </element-citation>
      </ref>
      <ref id="B9">
        <label>9</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Calza</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Raffelsberger</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Ploner</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Sahel</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Leveillard</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Pawitan</surname>
              <given-names>Y</given-names>
            </name>
          </person-group>
          <article-title>Filtering genes to improve sensitivity in oligonucleotide microarray data analysis</article-title>
          <source>Nucleic Acids Res</source>
          <year>2007</year>
          <volume>35</volume>
          <fpage>e102</fpage>
          <pub-id pub-id-type="pmid">17702762</pub-id>
        </element-citation>
      </ref>
      <ref id="B10">
        <label>10</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Huber</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>von Heydebreck</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>S&#xFC;ltmann</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Poustka</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Vingron</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Variance stabilization applied to microarray data calibration and to the quantification of differential expression</article-title>
          <source>Bioinformatics</source>
          <year>2002</year>
          <volume>18</volume>
          <issue>Suppl 1</issue>
          <fpage>S96</fpage>
          <lpage>S104</lpage>
          <pub-id pub-id-type="pmid">12169536</pub-id>
        </element-citation>
      </ref>
      <ref id="B11">
        <label>11</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kadota</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Nishiyama</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Shimizu</surname>
              <given-names>K</given-names>
            </name>
          </person-group>
          <article-title>A normalization strategy for comparing tag count data</article-title>
          <source>Algorithms Mol Biol</source>
          <year>2012</year>
          <volume>7</volume>
          <fpage>5</fpage>
          <pub-id pub-id-type="pmid">22475125</pub-id>
        </element-citation>
      </ref>
      <ref id="B12">
        <label>12</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Tarazona</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Garcia-Alcalde</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Dopazo</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Ferrer</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Conesa</surname>
              <given-names>A</given-names>
            </name>
          </person-group>
          <article-title>Differential expression in RNA-seq: a matter of depth</article-title>
          <source>Genome Res</source>
          <year>2011</year>
          <volume>21</volume>
          <fpage>2213</fpage>
          <lpage>2223</lpage>
          <pub-id pub-id-type="pmid">21903743</pub-id>
        </element-citation>
      </ref>
    </ref-list>
  </back>
  <floats-group>
    <fig id="F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <title>Five steps of typical RNA sequencing analysis pipeline, which are included in the TRAPR package. VSN, variance stabilizing normalization.</title>
      </caption>
      <graphic xlink:href="gni-15-51-g001"/>
    </fig>
  </floats-group>
</article>
</pmc-articleset>