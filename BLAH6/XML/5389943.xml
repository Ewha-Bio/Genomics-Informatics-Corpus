<?xml version="1.0" ?>
<!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd">
<pmc-articleset><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article">
  <?properties open_access?>
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">Genomics Inform</journal-id>
      <journal-id journal-id-type="iso-abbrev">Genomics Inform</journal-id>
      <journal-id journal-id-type="publisher-id">GNI</journal-id>
      <journal-title-group>
        <journal-title>Genomics &amp; Informatics</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1598-866X</issn>
      <issn pub-type="epub">2234-0742</issn>
      <publisher>
        <publisher-name>Korea Genome Organization</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmid">28416945</article-id>
      <article-id pub-id-type="pmc">5389943</article-id>
      <article-id pub-id-type="doi">10.5808/GI.2017.15.1.11</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Original Article</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>A ChIP-Seq Data Analysis Pipeline Based on Bioconductor Packages</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Park</surname>
            <given-names>Seung-Jin</given-names>
          </name>
          <xref ref-type="aff" rid="A1">1</xref>
          <xref ref-type="aff" rid="A2">2</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>Jong-Hwan</given-names>
          </name>
          <xref ref-type="aff" rid="A1">1</xref>
          <xref ref-type="aff" rid="A2">2</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Yoon</surname>
            <given-names>Byung-Ha</given-names>
          </name>
          <xref ref-type="aff" rid="A1">1</xref>
          <xref ref-type="aff" rid="A2">2</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>Seon-Young</given-names>
          </name>
          <xref ref-type="aff" rid="A1">1</xref>
          <xref ref-type="aff" rid="A2">2</xref>
        </contrib>
      </contrib-group>
      <aff id="A1"><label>1</label>Personalized Genomic Medicine Research Center, Korea Research Institute of Bioscience and Biotechnology (KRIBB), Daejeon 34141, Korea.</aff>
      <aff id="A2"><label>2</label>Department of Functional Genomics, University of Science and Technology (UST), Daejeon 34113, Korea.</aff>
      <author-notes>
        <corresp>Corresponding author: Tel: +82-42-879-8116, Fax: +82-42-879-8119, <email>kimsy@kribb.re.kr</email></corresp>
      </author-notes>
      <pub-date pub-type="ppub">
        <month>3</month>
        <year>2017</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>29</day>
        <month>3</month>
        <year>2017</year>
      </pub-date>
      <volume>15</volume>
      <issue>1</issue>
      <fpage>11</fpage>
      <lpage>18</lpage>
      <history>
        <date date-type="received">
          <day>31</day>
          <month>1</month>
          <year>2017</year>
        </date>
        <date date-type="rev-recd">
          <day>27</day>
          <month>2</month>
          <year>2017</year>
        </date>
        <date date-type="accepted">
          <day>06</day>
          <month>3</month>
          <year>2017</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>Copyright &#xA9; 2017 by the Korea Genome Organization</copyright-statement>
        <copyright-year>2017</copyright-year>
        <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
          <license-p>It is identical to the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>).</license-p>
        </license>
      </permissions>
      <abstract>
        <p>Nowadays, huge volumes of chromatin immunoprecipitation-sequencing (ChIP-Seq) data are generated to increase the knowledge on DNA-protein interactions in the cell, and accordingly, many tools have been developed for ChIP-Seq analysis. Here, we provide an example of a streamlined workflow for ChIP-Seq data analysis composed of only four packages in Bioconductor: dada2, QuasR, mosaics, and ChIPseeker. &#x2018;dada2&#x2019; performs trimming of the high-throughput sequencing data. &#x2018;QuasR&#x2019; and &#x2018;mosaics&#x2019; perform quality control and mapping of the input reads to the reference genome and peak calling, respectively. Finally, &#x2018;ChIPseeker&#x2019; performs annotation and visualization of the called peaks. This workflow runs well independently of operating systems (e.g., Windows, Mac, or Linux) and processes the input fastq files into various results in one run. R code is available at github: <ext-link ext-link-type="uri" xlink:href="https://github.com/ddhb/Workflow_of_Chipseq.git">https://github.com/ddhb/Workflow_of_Chipseq.git</ext-link>.</p>
      </abstract>
      <kwd-group>
        <kwd>chromatin immunoprecipitation</kwd>
        <kwd>data analysis</kwd>
        <kwd>next-generation sequencing</kwd>
        <kwd>statistical</kwd>
      </kwd-group>
      <funding-group>
        <award-group>
          <funding-source country="KR">
            <institution-wrap>
              <institution>National Research Foundation of Korea</institution>
              <institution-id institution-id-type="CrossRef">http://dx.doi.org/10.13039/501100003725</institution-id>
            </institution-wrap>
          </funding-source>
          <award-id>NRF-2012M3A9D1054670</award-id>
          <award-id>NRF-2014M3C9A3068554</award-id>
        </award-group>
      </funding-group>
    </article-meta>
  </front>
  <body>
    <sec sec-type="intro">
      <title>Introduction</title>
      <p>Various proteins interact with DNA in the nucleus. These interactions include many essential cellular processes, such as DNA replication, recombination, repair, transcription, and histone modifications [<xref rid="B1" ref-type="bibr">1</xref>]. Recent works have established that the eukaryotic chromatin is a dynamic and complex assembly of DNA, RNA, and proteins and is regulated by various post-translational modifications, including histone modifications, DNA methylation, long-range interactions, and non-coding RNAs [<xref rid="B2" ref-type="bibr">2</xref>]. The development of chromatin immunoprecipitation combined with chip or sequencing (ChIP-chip and later ChIP-Seq) has provided powerful methods to elucidate the complex interaction between DNA and proteins in the nucleus and has produced interesting data on complex DNA-protein interactions in the cell. By allowing genomewide analysis of DNA-protein interactions and histone modifications, ChIP-Seq has become one of the essential methods for genomic and epigenomic research.</p>
      <p>Along with the development of ChIP-Seq data generation methods, various algorithms, methods, and tools have been developed for various steps during ChIP-Seq data analysis. Now, the standard ChIP-Seq data analysis process consists of a quality check (QC), mapping, peak calling, statistical analysis, annotation, and visualization. There are several well-known tools for these steps: &#x2018;Trim Galore&#x2019; is one of the best programs to trim fastq reads, and &#x2018;FastQC&#x2019; is also one of the major tools for quality control and pre-processing of fastq files. These tools are found at <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/">http://www.bioinformatics.babraham.ac.uk/projects/</ext-link>. Bowtie and bwa are two representative tools for read mapping [<xref rid="B3" ref-type="bibr">3</xref><xref rid="B4" ref-type="bibr">4</xref>]. For peak calling, MACS2 is one of the most widely used tools in ChIP-Seq data analysis [<xref rid="B5" ref-type="bibr">5</xref>]. &#x2018;MAnorm&#x2019; can be conveniently used for statistical analysis of ChIP-Seq data [<xref rid="B6" ref-type="bibr">6</xref>], and &#x2018;PAVIS&#x2019; is available for biological interpretation of ChIP-Seq peaks in a user-friendly web interface [<xref rid="B7" ref-type="bibr">7</xref>]. While many tools have been developed for ChIP-Seq data analysis, no tool can provide all the necessary steps of ChIP-Seq data analysis in one environment. Also, many of the ChIP-Seq analysis tools need Unix-like environments (e.g., UNIX/LINUX or Mac OS X); so, most users of the Windows operating system have difficulty in using them.</p>
      <p>The Bioconductor project, which was launched in 2001, now contains more than 2,000 packages that facilitate the analysis and interpretation of high-throughput genomic data. As the Bioconductor project is based on the R statistical language, which is available for all of the major operating systems, most packages in Bioconductor can be run across different operating systems. In this regard, packages in the Bioconductor project provide an excellent platform for developing a streamlined analysis pipeline that can be run independently of platform. In this work, we selected four packages (dada2 [<xref rid="B8" ref-type="bibr">8</xref>], QuasR [<xref rid="B9" ref-type="bibr">9</xref>], mosaics [<xref rid="B10" ref-type="bibr">10</xref>], and ChIPseeker [<xref rid="B11" ref-type="bibr">11</xref>]) from the Bioconductor project, and made a ChIP-Seq data analysis pipeline that performs all the essential steps in one script. We hope that this example will help biologists with few bioinformatics skills in their analysis of ChIP-Seq data.</p>
    </sec>
    <sec sec-type="methods">
      <title>Methods</title>
      <sec>
        <title>Public data download</title>
        <p>While most researchers are likely to analyze their own data, some users may download public ChIP-Seq data from repositories, such as Short Read Archive (SRA) and the Encyclopedia of DNA Elements (ENCODE) project data portal. In this paper, we used a dataset from Gene Expression Omnibus (GSE29611; the data can be found at <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/ena/data/view/SRP006944">http://www.ebi.ac.uk/ena/data/view/SRP006944</ext-link>), one of the datasets from the ENCODE project [<xref rid="B12" ref-type="bibr">12</xref>], which aims to identify all functional elements in the human genome. Among the many samples in GSE29611, we used two samples from HeLa cells (<xref ref-type="table" rid="T1">Table 1</xref>).</p>
      </sec>
      <sec>
        <title>Description of packages and testing environment</title>
        <p>We used only four packages from beginning to end. The list of packages is shown in <xref ref-type="table" rid="T2">Table 2</xref>. The workflow in this paper was tested on a PC with an Intel i7 3.60 GHz processor and 16 GB memory using Microsoft R Open (version 3.3.0) in the Windows 8.1 pro K operating system.</p>
      </sec>
    </sec>
    <sec sec-type="results">
      <title>Results</title>
      <sec>
        <title>Overview of the ChIP-Seq analysis workflow</title>
        <p>We propose a ChIP-Seq analysis workflow composed of only four Bioconductor packages (<xref ref-type="table" rid="T2">Table 2</xref>). The four packages are available in all major operating systems and are simple to use (<xref ref-type="fig" rid="F1">Fig. 1</xref>).</p>
      </sec>
      <sec>
        <title>Setting the R environment and installing libraries to analyze (step 0 to step 1)</title>
        <p>First, we provide a short R code to install the Bioconductor-based program. Next, it provides the &#x2018;biocLite&#x2019; command to install the necessary package to analyze, the &#x2018;setwd&#x2019; command to set up the working directory, and the &#x2018;library&#x2019; command to load the package.</p>
      </sec>
      <sec>
        <title>(Optional) Data download from public repository (step 2)</title>
        <p>We downloaded two samples of the GSE29611 dataset from the European Bioinformatics Institute (EBI) database. We used EBI instead of SRA, as EBI provides both fastq and sra files, while SRA provides only sra files. By ftp protocol, it took about 45 min to download two fastq files from the EBI ftp site.</p>
      </sec>
      <sec>
        <title>Trimming the sequencing file (step 3)</title>
        <p>fastq file filtering is an important step when dealing with high-throughput sequencing data, because low-quality sequences can contain unexpected and misleading errors; especially, Illumina sequencing quality tends to drop off at the ends of reads, and the initial nucleotides can also be problematic due to calibration issues, such as trimming issues. The &#x2018;dada2&#x2019; package can filter and trim a fastq file with the &#x2018;fastqFilter&#x2019; function. &#x2018;fastqFilter&#x2019; takes an input fastq file and filters it, based on several user-definable criteria, and outputs those reads that pass the filter and their associated qualities to a new fastq file. The main parameters of the &#x2018;fastqfilter&#x2019; function are &#x2018;fn&#x2019; and &#x2018;fout,&#x2019; which indicate the path to the input fastq file and to the output file. Additionally, we adjusted the &#x2018;compress&#x2019; option to &#x2018;TRUE,&#x2019; because we use the compressed fastq file for analysis.</p>
      </sec>
      <sec>
        <title>Sequence alignment (step 4)</title>
        <p>The first step in ChIP-Seq data analysis is to align fastq files to a reference genome. The names of fastq files and the reference genome information (either a fasta file or BSgenome package) should be provided. As mapping is a time-consuming job, parallel processing using multiple cores is highly recommended. In R, parallel programming is supported by the 'BiocParallel' package, found at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/BiocParallel.html">https://bioconductor.org/packages/release/bioc/html/BiocParallel.html</ext-link>. QuasR, the abbreviation for &#x2018;Quantify and Annotate Short Reads,&#x2019; provides a framework for the quantification and analysis of short reads. &#x2018;qAlign&#x2019; is the function that generates alignment files in BAM format for all input sequence files against the reference genome. The qAlign function is a wrapper for the bowtie [<xref rid="B3" ref-type="bibr">3</xref>] and SpliceMap [<xref rid="B13" ref-type="bibr">13</xref>] tools.</p>
      </sec>
      <sec>
        <title>Quality check (step 5)</title>
        <p>The next step after sequence alignment is the QC of the aligned reads. The QC is performed by the &#x2018;qQCReport&#x2019; function of the qAlign package. It samples a random subset of sequences and alignments from each sample or an input file and generates a series of diagnostic plots for estimating data quality by various methods. The output consists of seven plots. The main plot is shown in <xref ref-type="fig" rid="F2">Fig. 2</xref>, and the other six plots are shown in Supplementary Files (<xref ref-type="fig" rid="F2">Fig. 2</xref>, <xref ref-type="supplementary-material" rid="S2">Supplementary Figs. 1</xref>, <xref ref-type="supplementary-material" rid="S3">2</xref>, <xref ref-type="supplementary-material" rid="S4">3</xref>, <xref ref-type="supplementary-material" rid="S5">4</xref>, <xref ref-type="supplementary-material" rid="S6">5</xref>, <xref ref-type="supplementary-material" rid="S7">6</xref>).</p>
      </sec>
      <sec>
        <title>Peak calling (step 6)</title>
        <p>For ChIP-Seq peak calling, we chose the &#x2018;mosaics&#x2019; package, which uses an adaptive and robust statistical approach; &#x2018;mosaics&#x2019; is an acronym of &#x201C;Model-Based One- and Two-sample Analysis and Inference for ChIP-Seq data.&#x201D; It implements a flexible parametric mixture modeling approach for detecting peaks&#x2014;e.g., enriched regions&#x2014;in one-sample (ChIP sample) or two-sample (ChIP and matched control samples) ChIP-Seq data. It can account for mappability and GC content biases that arise in ChIP-Seq data [<xref rid="B10" ref-type="bibr">10</xref>]. Recently, &#x2018;mosaics&#x2019; extended the framework with a hidden Markov Model (HMM) architecture, named mosaics-HMM [<xref rid="B14" ref-type="bibr">14</xref>], to identify broad peaks; so, mosaics is useful for the analysis of both sharp and broad peaks. As for broad peaks, mosaics has two methods: &#x2018;mosaicsFitHMM&#x2019; and &#x2018;mosaicsPeakHMM.&#x2019; For computational efficiency, &#x2018;mosaicsFitHMM&#x2019; utilizes MOSAiCS model fit as estimates of emission distribution of the MOSAiCS-HMM model. In addition, it also considers MOSAiCS peak calling results at a specified false discovery rate (FDR) level as initial values by default. For more information, please peruse the vignette on 'mosaics' in Bioconductor. Here, we describe an example of a sharp peak calling process.</p>
      </sec>
      <sec>
        <title>Calling of sharp peaks (steps 6-2 to 6-5)</title>
        <p>For peak calling, mosaics first constructs bin-level files from aligned read files for modeling and visualization. The &#x2018;infile&#x2019; argument indicates the name of the aligned files, and the &#x2018;fileFormat&#x2019; argument indicates the data format of the &#x2018;infile.&#x2019; Also, several arguments should be provided: &#x2018;bychr,&#x2019; &#x2018;PET,&#x2019; &#x2018;fragLen,&#x2019; &#x2018;binsize,&#x2019; and &#x2018;capping.&#x2019; The meaning of each argument is given in &#x2018;constructing separate bin-level file for each chromosome,&#x2019; &#x2018;paired-end tag,&#x2019; &#x2018;average fragment length,&#x2019; &#x2018;size of bins,&#x2019; and &#x2018;maximum number of reads allowed to start at each nucleotide position,&#x2019; respectively [<xref rid="B10" ref-type="bibr">10</xref>]. Then, binned data are read into the R environment. Here, for the &#x2018;type&#x2019; argument, &#x2018;input&#x2019; and &#x2018;chip&#x2019; indicate either a control or ChIP-Seq data file, respectively. &#x2018;readBins&#x2019; is a versatile function, which imports and preprocesses all or a subset of bin-level ChIP-Seq data, including ChIP data, matched control data, mappability score, GC content score, and sequence ambiguity score. The next step is to fit the MOSAiCS model. The &#x2018;mosaicsFit&#x2019; function performs fitting of one-sample or two-sample MOSAiCS models with one signal component or two signal components. The &#x2018;analysisType&#x2019; parameter uses &#x2018;OS (one-sample analysis),&#x2019; &#x2018;TS (two-sample analysis using mappability and GC content),&#x2019; or &#x2018;IO (two-sample analysis without using mappability and GC content).&#x2019; The &#x2018;bgEst&#x2019; parameter selects a background estimation approach from either &#x2018;matchLow (estimation using bins with low tag counts)&#x2019; or &#x2018;rMOM (estimation using robust method of moment).&#x2019; After model fitting, peaks are identified. The sharp peaks are identified by applying the two-signal component model at a given FDR. Here, the argument &#x2018;signalModel=2S&#x2019; indicates the two-signal component model, while &#x2018;signalModel=1S&#x2019; indicates the one-signal component model. The FDR can be controlled at the desired level by specifying the &#x2018;FDR&#x2019; argument. Initial nearby peaks are merged if the distance (bp) between them is less than maxgap on the argument &#x2018;maxgap.&#x2019; The &#x2018;minsize&#x2019; argument sets a threshold to remove peaks whose width is narrower than the given value. &#x2018;thres&#x2019; sets a threshold for ChIP tag counts for peaks. Called peaks can be exported in diverse file formats, including the TXT, BED, GFF, narrow-Peak, and BroadPeak file formats.</p>
      </sec>
      <sec>
        <title>Calling of broad peaks (<xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref>)</title>
        <p>We provide another version of R code for calling broad peaks (Supplementary Methods, <xref ref-type="supplementary-material" rid="S8">Supplementary Figs. 7</xref>, <xref ref-type="supplementary-material" rid="S9">8</xref>, <xref ref-type="supplementary-material" rid="S10">9</xref>, <xref ref-type="supplementary-material" rid="S11">10</xref>, <xref ref-type="supplementary-material" rid="S12">11</xref>).</p>
      </sec>
      <sec>
        <title>Annotation and visualization (step 7)</title>
        <p>The main input format for the ChIPSeeker package [<xref rid="B13" ref-type="bibr">13</xref>] is a bed file. &#x2018;readPeakFile&#x2019; reads data from the input file and stores them in a data.frame or Granges object.</p>
        <sec>
          <title>ChIP peaks coverage plot (Step 7-2)</title>
          <p>The &#x2018;Covplot&#x2019; function calculates the coverage of peak regions over chromosomes and generates a figure (<xref ref-type="fig" rid="F3">Fig. 3</xref>). The &#x2018;weightCol&#x2019; argument indicates the peak score, and &#x2018;V5&#x2019; means the fifth column.</p>
        </sec>
        <sec>
          <title>Heatmap and average profiling of chip peaks binding to transcription start site regions (<xref ref-type="fig" rid="F4">Fig. 4A and 4B</xref>) (step 7-3)</title>
          <p>First, transcription start site (TSS) regions are prepared by invoking the &#x2018;getPromoter&#x2019; function. Then, peaks are mapped to the TSS regions, generating tagMatrix. The &#x2018;tagHeatmap&#x2019; function plots the heatmap based on the tagMatrix data. The &#x2018;plotAvgProf&#x2019; function plots the average profile of the peaks binding to TSS regions (i.e., 5&#x2032; to 3&#x2032;) based on read count frequency.</p>
        </sec>
        <sec>
          <title>Peak annotation (step 7-4)</title>
          <p>The TSS region, defined by default from &#x2212;3 kb to +3 kb; the Txdb, and the corresponding annoDb of interest (here, <italic>Homo sapiens</italic>) should be provided for gene annotation. Then, the annotatePeak function generates annotation information for the given input. Basically, the position and strand information of the nearest genes are reported. The distance from the peak to the TSS of the nearest gene is also reported. The genomic region of the peak is reported in the annotation column. Since some annotations may overlap, the &#x2018;annotePeak&#x2019; package adopts the following priority in the genomic annotation: Promoter &#x2192; 5&#x2032; UTR &#x2192; 3&#x2032; UTR &#x2192; Exon &#x2192; Intron &#x2192; Downstream &#x2192; Intergenic.</p>
        </sec>
        <sec>
          <title>Visualization of genomic annotation (step 7-4)</title>
          <p>The &#x2018;annotatePeak&#x2019; function assigns peaks to genomic annotation in the &#x201C;annotation&#x201D; column of the output, which includes whether a peak is in the TSS, exon, 5&#x2032; untranslated region (UTR), or 3&#x2032; UTR or intronic or intergenic. The &#x2018;plotAnnoPie&#x2019; function provides a pie chart of peak annotations by genomic region (<xref ref-type="fig" rid="F5">Fig. 5</xref>). The distribution of genomic annotation can also be visualized by a histogram (<xref ref-type="fig" rid="F6">Fig. 6</xref>).</p>
        </sec>
        <sec>
          <title>Functional enrichment analysis (step 7-5)</title>
          <p>The annotated genes can be used as an input for functional enrichment analysis. The &#x2018;seq2gene&#x2019; function changes peak information into gene information, which is used by the &#x2018;enrichPathway&#x2019; function for pathway enrichment analysis (<xref ref-type="fig" rid="F7">Fig. 7</xref>).</p>
        </sec>
      </sec>
    </sec>
    <sec sec-type="discussion">
      <title>Discussion</title>
      <p>ChIP-Seq is one of major applications using next-generation sequencing technology and provides valuable information on DNA-protein interactions and epigenomic modifications. Due to its high volume of sequence data, most ChIP-Seq data analysis is performed in Unix/Linux or equivalent environments (e.g., Mac OS X). Considering that the Microsoft Windows operating system (OS) still dominates the market share of the PC OS, it would be helpful to have a ChIP-Seq data analysis pipeline that can be run on Windows OS without the use of a Unix-like OS environment.</p>
      <p>In this regard, R/Bioconductor provides an excellent opportunity to make an analysis pipeline in an OS-independent manner. First, R/Bioconductor is available for all major platforms (Windows, Mac OS X, and most Linux). Second, most R/Bioconductor packages and scripts can be run across different OS platforms without any modifications. Third, the Bioconductor is an open-source, interdisciplinary, and collaborative software project for the analysis and comprehension of high-throughput data in genomics and molecular biology and provides a lot of useful packages for genomic data analysis [<xref rid="B15" ref-type="bibr">15</xref>]. Thus, many useful analysis pipelines can be constructed by deliberately selecting adequate packages among thousands of available high-quality packages. Fourth, R/Bioconductor provides many sophisticated statistical analysis and visualization tools. Indeed, R/Bioconductor is one of the most versatile and advanced visualization systems; so, many high-quality plots in the scientific community are produced using R/Bioconductor.</p>
      <p>In this work, we presented a ChIP-Seq data analysis pipeline using only four Bioconductor packages. The entire workflow took only about 2 h in the Windows 7 OS with two Intel i7 quad-cores (3.4 GHz) and 16 GB RAM. Thus, for ChIP-Seq data analysis, we insist that high-end workstations and servers with UNIX-like environments are not mandatory any longer. With careful selection of packages and tools, it is possible to construct an efficient data analysis pipeline on a PC machine. Although more than 60 packages are available for ChIP-Seq data analysis, we deliberately selected four packages to encompass all the necessary steps of ChIP-Seq data analyses, including trimming, mapping and QC, peak calling, peak annotation, and visualization. However, we acknowledge that many other packages with similar functions are also available and can thus be used to construct alternative data analysis pipelines.</p>
      <p>In the next version, we will add an option to choose a peak calling algorithm with various statistical analysis options from diverse programs. We hope that our work will help most biologists perform ChIP-Seq data analysis without setting up additional Unix-like environments.</p>
    </sec>
  </body>
  <back>
    <ack>
      <title>Acknowledgments</title>
      <p>This work was supported by grants from the genomics (NRF-2012M3A9D1054670 and NRF-2014M3C9A3068554) programs of the National Research Foundation of Korea, which is funded by the Ministry of Science, ICT, and Future Planning, and the KRIBB Research Initiative.</p>
    </ack>
    <ref-list>
      <ref id="B1">
        <label>1</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Mundade</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Ozer</surname>
              <given-names>HG</given-names>
            </name>
            <name>
              <surname>Wei</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Prabhu</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Lu</surname>
              <given-names>T</given-names>
            </name>
          </person-group>
          <article-title>Role of ChIP-seq in the discovery of transcription factor binding sites, differential gene regulation mechanism, epigenetic marks and beyond</article-title>
          <source>Cell Cycle</source>
          <year>2014</year>
          <volume>13</volume>
          <fpage>2847</fpage>
          <lpage>2852</lpage>
          <pub-id pub-id-type="pmid">25486472</pub-id>
        </element-citation>
      </ref>
      <ref id="B2">
        <label>2</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gentsch</surname>
              <given-names>GE</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>JC</given-names>
            </name>
          </person-group>
          <article-title>Efficient preparation of high-complexity ChIP-Seq profiles from early <italic>Xenopus</italic> embryos</article-title>
          <source>Methods Mol Biol</source>
          <year>2017</year>
          <volume>1507</volume>
          <fpage>23</fpage>
          <lpage>42</lpage>
          <pub-id pub-id-type="pmid">27832530</pub-id>
        </element-citation>
      </ref>
      <ref id="B3">
        <label>3</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Langmead</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Salzberg</surname>
              <given-names>SL</given-names>
            </name>
          </person-group>
          <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
          <source>Nat Methods</source>
          <year>2012</year>
          <volume>9</volume>
          <fpage>357</fpage>
          <lpage>359</lpage>
          <pub-id pub-id-type="pmid">22388286</pub-id>
        </element-citation>
      </ref>
      <ref id="B4">
        <label>4</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Li</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Durbin</surname>
              <given-names>R</given-names>
            </name>
          </person-group>
          <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
          <source>Bioinformatics</source>
          <year>2009</year>
          <volume>25</volume>
          <fpage>1754</fpage>
          <lpage>1760</lpage>
          <pub-id pub-id-type="pmid">19451168</pub-id>
        </element-citation>
      </ref>
      <ref id="B5">
        <label>5</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Zhang</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Liu</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Meyer</surname>
              <given-names>CA</given-names>
            </name>
            <name>
              <surname>Eeckhoute</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Johnson</surname>
              <given-names>DS</given-names>
            </name>
            <name>
              <surname>Bernstein</surname>
              <given-names>BE</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
          <source>Genome Biol</source>
          <year>2008</year>
          <volume>9</volume>
          <fpage>R137</fpage>
          <pub-id pub-id-type="pmid">18798982</pub-id>
        </element-citation>
      </ref>
      <ref id="B6">
        <label>6</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Shao</surname>
              <given-names>Z</given-names>
            </name>
            <name>
              <surname>Zhang</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Yuan</surname>
              <given-names>GC</given-names>
            </name>
            <name>
              <surname>Orkin</surname>
              <given-names>SH</given-names>
            </name>
            <name>
              <surname>Waxman</surname>
              <given-names>DJ</given-names>
            </name>
          </person-group>
          <article-title>MAnorm: a robust model for quantitative comparison of ChIP-Seq data sets</article-title>
          <source>Genome Biol</source>
          <year>2012</year>
          <volume>13</volume>
          <fpage>R16</fpage>
          <pub-id pub-id-type="pmid">22424423</pub-id>
        </element-citation>
      </ref>
      <ref id="B7">
        <label>7</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Huang</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Loganantharaj</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Schroeder</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Fargo</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Li</surname>
              <given-names>L</given-names>
            </name>
          </person-group>
          <article-title>PAVIS: a tool for Peak Annotation and Visualization</article-title>
          <source>Bioinformatics</source>
          <year>2013</year>
          <volume>29</volume>
          <fpage>3097</fpage>
          <lpage>3099</lpage>
          <pub-id pub-id-type="pmid">24008416</pub-id>
        </element-citation>
      </ref>
      <ref id="B8">
        <label>8</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Callahan</surname>
              <given-names>BJ</given-names>
            </name>
            <name>
              <surname>McMurdie</surname>
              <given-names>PJ</given-names>
            </name>
            <name>
              <surname>Rosen</surname>
              <given-names>MJ</given-names>
            </name>
            <name>
              <surname>Han</surname>
              <given-names>AW</given-names>
            </name>
            <name>
              <surname>Johnson</surname>
              <given-names>AJ</given-names>
            </name>
            <name>
              <surname>Holmes</surname>
              <given-names>SP</given-names>
            </name>
          </person-group>
          <article-title>DADA2: high-resolution sample inference from Illumina amplicon data</article-title>
          <source>Nat Methods</source>
          <year>2016</year>
          <volume>13</volume>
          <fpage>581</fpage>
          <lpage>583</lpage>
          <pub-id pub-id-type="pmid">27214047</pub-id>
        </element-citation>
      </ref>
      <ref id="B9">
        <label>9</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gaidatzis</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Lerch</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Hahne</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Stadler</surname>
              <given-names>MB</given-names>
            </name>
          </person-group>
          <article-title>QuasR: quantification and annotation of short reads in R</article-title>
          <source>Bioinformatics</source>
          <year>2015</year>
          <volume>31</volume>
          <fpage>1130</fpage>
          <lpage>1132</lpage>
          <pub-id pub-id-type="pmid">25417205</pub-id>
        </element-citation>
      </ref>
      <ref id="B10">
        <label>10</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kuan</surname>
              <given-names>PF</given-names>
            </name>
            <name>
              <surname>Chung</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Pan</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Thomson</surname>
              <given-names>JA</given-names>
            </name>
            <name>
              <surname>Stewart</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Kele&#x15F;</surname>
              <given-names>S</given-names>
            </name>
          </person-group>
          <article-title>A statistical framework for the analysis of ChIP-Seq data</article-title>
          <source>J Am Stat Assoc</source>
          <year>2011</year>
          <volume>106</volume>
          <fpage>891</fpage>
          <lpage>903</lpage>
          <pub-id pub-id-type="pmid">26478641</pub-id>
        </element-citation>
      </ref>
      <ref id="B11">
        <label>11</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yu</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>LG</given-names>
            </name>
            <name>
              <surname>He</surname>
              <given-names>QY</given-names>
            </name>
          </person-group>
          <article-title>ChIPseeker: an R/Bioconductor package for ChIP peak annotation, comparison and visualization</article-title>
          <source>Bioinformatics</source>
          <year>2015</year>
          <volume>31</volume>
          <fpage>2382</fpage>
          <lpage>2383</lpage>
          <pub-id pub-id-type="pmid">25765347</pub-id>
        </element-citation>
      </ref>
      <ref id="B12">
        <label>12</label>
        <element-citation publication-type="journal">
          <collab>ENCODE Project Consortium</collab>
          <article-title>The ENCODE (ENCyclopedia Of DNA Elements) Project</article-title>
          <source>Science</source>
          <year>2004</year>
          <volume>306</volume>
          <fpage>636</fpage>
          <lpage>640</lpage>
          <pub-id pub-id-type="pmid">15499007</pub-id>
        </element-citation>
      </ref>
      <ref id="B13">
        <label>13</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Au</surname>
              <given-names>KF</given-names>
            </name>
            <name>
              <surname>Jiang</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Lin</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Xing</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Wong</surname>
              <given-names>WH</given-names>
            </name>
          </person-group>
          <article-title>Detection of splice junctions from paired-end RNA-seq data by SpliceMap</article-title>
          <source>Nucleic Acids Res</source>
          <year>2010</year>
          <volume>38</volume>
          <fpage>4570</fpage>
          <lpage>4578</lpage>
          <pub-id pub-id-type="pmid">20371516</pub-id>
        </element-citation>
      </ref>
      <ref id="B14">
        <label>14</label>
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Chung</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Zhang</surname>
              <given-names>Q</given-names>
            </name>
            <name>
              <surname>Kele&#x15F;</surname>
              <given-names>S</given-names>
            </name>
          </person-group>
          <chapter-title>MOSAiCS-HMM: a model-based approach for detecting regions of histone modifications from ChIP-Seq data</chapter-title>
          <person-group person-group-type="editor">
            <name>
              <surname>Datta</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Nettleton</surname>
              <given-names>D</given-names>
            </name>
          </person-group>
          <source>Statistical Analysis of Next Generation Sequencing Data</source>
          <publisher-loc>New York</publisher-loc>
          <publisher-name>Springer</publisher-name>
          <year>2014</year>
          <fpage>277</fpage>
          <lpage>295</lpage>
        </element-citation>
      </ref>
      <ref id="B15">
        <label>15</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Huber</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Carey</surname>
              <given-names>VJ</given-names>
            </name>
            <name>
              <surname>Gentleman</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Anders</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Carlson</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Carvalho</surname>
              <given-names>BS</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>
          <source>Nat Methods</source>
          <year>2015</year>
          <volume>12</volume>
          <fpage>115</fpage>
          <lpage>121</lpage>
          <pub-id pub-id-type="pmid">25633503</pub-id>
        </element-citation>
      </ref>
    </ref-list>
    <sec sec-type="supplementary-material">
      <title>Supplementary materials</title>
      <p>Supplementary data including 11 figures and Supplementary methods can be found with this article online at <ext-link ext-link-type="uri" xlink:href="http://www.genominfo.org/src/sm/gni-15-11-s001.pdf">http://www.genominfo.org/src/sm/gni-15-11-s001.pdf</ext-link>.</p>
      <supplementary-material content-type="local-data" id="S1">
        <caption>
          <title>Supplementary Methods</title>
          <p>Calling of broad peaks (step 6 in broad peak script)</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s001.pdf" orientation="portrait" id="d35e1003" position="anchor"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="S2">
        <caption>
          <title>Supplementary Fig. 1</title>
          <p>Nucleotide frequency. These plots show the frequency of A, C, G, T, and N bases by position in the input reads.</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s002.pdf" orientation="portrait" id="d35e1010" position="anchor"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="S3">
        <caption>
          <title>Supplementary Fig. 2</title>
          <p>Duplication level. The most frequent sequences are listed; at the same time, these plots show the fraction of reads observed at different duplication levels for each sample.</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s003.pdf" orientation="portrait" id="d35e1017" position="anchor"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="S4">
        <caption>
          <title>Supplementary Fig. 3</title>
          <p>Mapping statistics. It shows the fraction of reads that were the portion of mappable and unmappable to the reference genome. The percentages of mapped reads were 79.5% and 77.7%, respectively.</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s004.pdf" orientation="portrait" id="d35e1024" position="anchor"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="S5">
        <caption>
          <title>Supplementary Fig. 4</title>
          <p>Library complexity. It shows the fractions of unique and non-unique read alignment positions. This measure is not independent of the total number of reads in a library. The percentages of unique mapped reads are 85.7% and 93.7%, respectively.</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s005.pdf" orientation="portrait" id="d35e1031" position="anchor"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="S6">
        <caption>
          <title>Supplementary Fig. 5</title>
          <p>Mismatch frequency. It shows the frequency and position of mismatches in the alignments against the reference genome.</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s006.pdf" orientation="portrait" id="d35e1038" position="anchor"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="S7">
        <caption>
          <title>Supplementary Fig. 6</title>
          <p>Mismatch type. It shows the frequency of read bases that caused mismatches in the alignments to the reference genome, separately for each genome base.</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s007.pdf" orientation="portrait" id="d35e1045" position="anchor"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="S8">
        <caption>
          <title>Supplementary Fig. 7</title>
          <p>Coverage plot. Coverage plot visualizes the broad peak locations over the whole genome.</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s008.pdf" orientation="portrait" id="d35e1052" position="anchor"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="S9">
        <caption>
          <title>Supplementary Fig. 8</title>
          <p>(A) Heatmap of chromatin immunoprecipitation (ChIP) binding to transcription start site (TSS) regions. (B) Average profile of ChIP peaks binding to TSS regions. It shows the read count frequency of the broad peak sample in the range from &#x2212;3000 bp to +3000 bp.</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s009.pdf" orientation="portrait" id="d35e1059" position="anchor"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="S10">
        <caption>
          <title>Supplementary Fig. 9</title>
          <p>Pie chart of different genomic regions. UTR, untranslated region.</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s010.pdf" orientation="portrait" id="d35e1067" position="anchor"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="S11">
        <caption>
          <title>Supplementary Fig. 10</title>
          <p>UpSet plot. UTR, untranslated region.</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s011.pdf" orientation="portrait" id="d35e1074" position="anchor"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="S12">
        <caption>
          <title>Supplementary Fig. 11</title>
          <p>Functional enrichment analysis. It identifies predominant biological themes among the nearest genes associated with the broad peak by incorporating biological knowledge provided by biological ontologies.</p>
        </caption>
        <media mimetype="application" mime-subtype="pdf" xlink:href="gni-15-11-s012.pdf" orientation="portrait" id="d35e1081" position="anchor"/>
      </supplementary-material>
    </sec>
  </back>
  <floats-group>
    <fig id="F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <title>Workflow of chromatin immunoprecipitation-sequencing (ChIP-Seq) data analysis using Bioconductor packages. Four packages are used in this workflow. The &#x2018;dada2&#x2019; package performs the trimming of high-throughput sequencing file. The &#x2018;QuasR&#x2019; package performs alignment and quality check. The &#x2018;mosaic&#x2019; package, which is the core of this workflow, performs the peak calling step. The last package, &#x2018;ChIPseeker,&#x2019; performs annotation, visualization, and functional enrichment analysis.</title>
      </caption>
      <graphic xlink:href="gni-15-11-g001"/>
    </fig>
    <fig id="F2" orientation="portrait" position="float">
      <label>Fig. 2</label>
      <caption>
        <title>Boxplot of the quality score distribution per base position in reads. It shows the distribution of the base quality values for each position from the input sequence. In this figure, both the control sample and IP sample have very high quality scores.</title>
      </caption>
      <graphic xlink:href="gni-15-11-g002"/>
    </fig>
    <fig id="F3" orientation="portrait" position="float">
      <label>Fig. 3</label>
      <caption>
        <title>Coverage plot. It visualizes the peak locations over the whole genome. It is made for calculating the coverage of peak regions over chromosomes.</title>
      </caption>
      <graphic xlink:href="gni-15-11-g003"/>
    </fig>
    <fig id="F4" orientation="portrait" position="float">
      <label>Fig. 4</label>
      <caption>
        <title>(A) Heatmap of chromatin immunoprecipitation (ChIP) binding to transcription start site (TSS) regions. It shows the profile of ChIP peaks binding to TSS regions, which are defined as the flanking sequence of TSSs. (B) Average profile of ChIP peaks binding to TSS regions. The average profile of the ChIP peaks is a graph showing the read count frequency in the range from &#x2013;3000 bp to +3000 bp. Since the H3K4me3 state is a promoter marker, the read count frequency is high in the TSS region.</title>
      </caption>
      <graphic xlink:href="gni-15-11-g004"/>
    </fig>
    <fig id="F5" orientation="portrait" position="float">
      <label>Fig. 5</label>
      <caption>
        <title>Pie chart of different genomic regions. There are various parts, including distance promoter and two untranslated regions (UTRs). In particular, the distal intergenic region and the promoter region for 1&#x2212;2 kb are dominant in the analysis above.</title>
      </caption>
      <graphic xlink:href="gni-15-11-g005"/>
    </fig>
    <fig id="F6" orientation="portrait" position="float">
      <label>Fig. 6</label>
      <caption>
        <title>UpSet plot. Matrix layout for all interactions of 7 regions, sorted by size. Dark circles in the matrix indicate sets that are part of the intersection. UTR, untranslated region.</title>
      </caption>
      <graphic xlink:href="gni-15-11-g006"/>
    </fig>
    <fig id="F7" orientation="portrait" position="float">
      <label>Fig. 7</label>
      <caption>
        <title>Functional enrichment analysis. It identifies predominant biological themes among the nearest genes by incorporating biological knowledge provided by biological ontologies. It shows results in the gene region from &#x2013;1000 to +1000 of the transcription start site. The top 3 circles in the figure have p-values of 1.837e-32, 1.970e-29, and 6.854e-21, respectively.</title>
      </caption>
      <graphic xlink:href="gni-15-11-g007"/>
    </fig>
    <table-wrap id="T1" orientation="portrait" position="float">
      <label>Table 1</label>
      <caption>
        <title>Public datasets used in ChIP-Seq data analysis</title>
      </caption>
      <graphic xlink:href="gni-15-11-i001"/>
      <table-wrap-foot>
        <fn>
          <p>ChIP-Seq, chromatin immunoprecipitation-sequencing.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap id="T2" orientation="portrait" position="float">
      <label>Table 2</label>
      <caption>
        <title>Bioconductor packages used in this study</title>
      </caption>
      <graphic xlink:href="gni-15-11-i002"/>
    </table-wrap>
  </floats-group>
</article>
</pmc-articleset>