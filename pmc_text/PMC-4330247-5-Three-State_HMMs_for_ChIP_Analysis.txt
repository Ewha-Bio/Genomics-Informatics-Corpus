One general limitation of the methods in the previous section is that they only enable binary classification. For this reason, a three-state HMM has been proposed for the analysis of so-called differential histone modification sites (DHMSs) of H3K27me3 by Xu et al. [18]. To capture the histone modifications on the whole-genome scale, Xu et al. [18] proposed a qualitative analysis for the genome-wide comparison of histone modification sites by computationally comparing two ChIP-seq libraries generated from different cell types or experimental conditions. To do that, the whole genome was partitioned into 1-kb bins, and the number of centers of ChIP fragments was counted and normalized in each bin, generating a profile of ChIP fragment counts.
Based on the observations of ChIP fragment counts, Fig. 4 shows an HMM to infer the states of histone modification changes at each genomic location. The HMM is characterized by three features: the prior probability of the start state, the emission probability, and the transmission probability. A DHMS was defined as a bin in which the ratio of intensities between two profiles (L1 and L2) is larger than τ (L1-enriched DHMSs) or smaller than 1/τ (L2-enriched DHMSs), where τ is a predetermined threshold [19]. Based on the definition of a DHMS, the state Si takes one of the following three values: α0 if 1/τ ≤ p(1,i)/p(2,i) ≤ τ; α1 if p(1,i)/p(2,i) > τ; and α2 if p(1,i)/p(2,i) < 1/τ. (For a region of k bins, the notation x1,i, x2,i was used for the ChIP fragment counts in L1 and L2, and the notation p1,i, p2,i was used for the intensity in L1 and L2, respectively, at the ith bin in that region.) The initial state is fixed to take the value of α0, since the region is assumed to start from the genomic locations where the histone modification is depleted in both libraries. The emission probability P(x1,i, x2,i ∣si) was calculated as in Fig. 4 by integrating p1,i and p2,i over all possible values constrained by si. The transmission probability table was trained using the Baum-Welch algorithm [21].
Other methods of three-state HMMs for the identification of methylated regions have been proposed. Seifert et al. [26] also proposed a three-state HMM specifically designed for the analysis of Arabidopsis MeDIP-chip data to differentiate between unmethylated ('U'), methylated ('M'), and highly methylated regions ('I'). They utilized a three-state HMM with state-specific multivariate Gaussian emission densities to analyze methylation levels of chromosomal regions in methylation profiles. Arand et al. [27] suggested a four-state HMM (fully methylated, not methylated on both sides, methylated only on the lower strand, and methylated only on the upper strand) to determine the methylation status of both DNA strands.