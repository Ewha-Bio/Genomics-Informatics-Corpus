The Sherman-Morrison-Woodbury lemma
From the relationship Gu-1 = ZTG-1Z, we should calculate the inverse matrix of the Gu-1 matrix. Because a lot of time was needed for calculating the inverse matrix directly, we used the Sherman-Morrison-Woodbury (SMW) lemma [20, 21, 22, 23]. The formula was as follows: (A + YGZ*)-1 = A-1 - A-1Y(G-1 + Z*A-1Y)-1Z*A-1,(9) where A and G are both invertible, and A + YGZ* are invertible if and only if G-1 + Z*A-1 Y are invertible. Practically, to reduce the error, we used A as the identity matrix (I matrix), and the practically used formula was as follows: (10)
Calculating the SNP-SNP relationship matrix Gu using the lemma was faster than the direct calculation, because we used larger SNPs than the sample size.