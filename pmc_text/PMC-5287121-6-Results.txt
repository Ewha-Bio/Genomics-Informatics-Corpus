Optimality of SZ
SZ maximizes the non-centrality parameter
SZ combines z-scores from multiple studies to construct a new z-score. Therefore, in SZ, we are not interested in the estimator of Xi. Rather, we are interested in the statistical significance of the combined information. Thus, the goal of SZ is to maximize how much the z-score will be shifted from 0 on average, which is often called the non-centrality parameter. By maximizing the non-centrality parameter, we can maximize the statistical power of the test. Among all possible weights that can construct a weighted SZ, we want to find the weights that will maximize the non-centrality parameter.
The optimal weights of the weighted SZ can be found by the Cauchy-Schwarz inequality. We will make an assumption that Zi=Xi/Vi. (10)
That is, we assume that our z-score is defined as the effect size estimate divided by the standard error, which is the common definition of a z-score. In some applications, there can be different ways to define a z-score statistic, and for those definitions, the connection between z-score and effect size may not be apparent. However, in practice, this assumption holds approximately over a wide range of applications. Below, we will show that in the situation of a 2 × 2 table, even if we obtain a z-score in a different way, it approximates a z-score that is obtained by using effect size and its standard error.
Under the fixed effect model assumption that assumes E[Xi] = µ, the z-score, Zi, follows a normal distribution ZSZ~N(λ,1), where λ is a non-centrality parameter with λ=∑i=1nwSZ, i(µ/Vi)/∑i=1nwSZ, i2. Now, we want to obtain the weight wi that maximizes lambda. The optimal weight can be obtained by using the Cauchy-Schwarz inequality, as follows [1221]: λ=∑i=1nwSZ, i∑i=1nwSZ, i2•1Vi≤µ∑i=1nwSZ, i2∑i=1nwSZ, i2∑i=1n1Vi. (11)
The equality is achieved when wSZ, i∑i=1nwSZ, i2=k•1Vi, (12) where the terms ∑i=1nwSZ, i2 and k are constants. Thus, the optimal weight is wSZ, i=1/Vi. Then, the resulting weighted SZ can be constructed as ZSZ=∑i=1nSEXi−1Zi∑i=1nSEXi−2. (13)
This result provides us with the intuition that SZ is optimal only when we weight z-scores by the inverse of the standard errors of effect sizes. That is why previous studies have weighted z-scores by Ni, because in many applications, the variance Vi is inversely proportional to the sample size Ni. However, we would like to note that in some applications, the variance can be a function of not only Ni but also other properties of the data. For example, in genetic association studies, when we test an association of a single-nucleotide polymorphism (SNP) to a phenotype, the variance is typically inversely proportional to Nipi(1−pi), where pi denotes the allele frequency of the risk allele. This suggests that if the datasets that we want to combine have different allele frequencies, weighting the z-scores only by Ni can be suboptimal. Below, we will show by simulations that we can have some power loss by using just Ni as the weight, instead of accounting for frequency differences. However, the approximation of this weight Ni will be optimal when no heterogeneity can be found between the minor allele frequencies [2].