The method of statistical SNP-SNP variance-covariance matrix calculation
From the regression Eq. (1), Henderson [19] used the ML method to derive the BLUP equation, which is in the form: f(y, u) = g(y|u)h(u) = g(Xb + Zu + e|u)h(u) = g(e)m(u).(3)
Then, we used Zu as the independent variable instead of u, which denotes the breeding value or genetic value Zu for the derivation of BLUP. We assumed the normality condition of the genetic value Zu and random effect u. Based on these assumptions, the variance-covariance matrix of genetic values, Zu, is the GRM, G. f(y, Zu) = g(y|Zu)h(Zu) = g(e)m(Zu) = g(e)k(u)(4)
From Eqs. (3) and (4), (5)
(6)
Eqs. (5) and (6) represent the probability density function (pdf) of the BLUP model (Eq. 1). Eqs. (5) and (6) are equivalent, and we can easily know that Gu-1 = ZTG-1Z. This important relationship links the SNP-SNP variance covariance matrix Gu to the GRM G.