Data processing
Using BclToFastq, the .bcl file was processed and divided into fastq files of read 1 (R1), read 2 (R2), and UMI. To generated unmapped bam files, R1.fastq and R2.fastq files were processed using FastqToBam (Fulcrum Genomics/fgbio, v0.7.0) (Fig. 1). Unmapped.bam file was then sorted using SortSam (Picard) to sort files compatible with downstream tools. UMI information was annotated via AnnotateBamWithUmis (fgbio). To use MergeBamAlignment (Picard) to generate UMI-annotated mapped bam files, SamToFastq (Picard) generated fastq files containing UMI information. Burrows-Wheeler Aligner (BWA-mem, v0.1.17) aligned reads to the hg38 reference genome [15]. The unmapped bam files (output of Tool#3) and the aligned bam file (the output of BWA-mem) were merged via MergeBamAlignment (Picard). Mapped.bam file was then grouped by GroupReadsByUmi (fgbio) according to its RX-tagged UMI sequence. UMI family information was then used for grouping and calling consensus reads via CallMolecularConsensusReads (fgbio). FilterConsensusReads (fgbio) filters consensus reads to make bam files suitable for further variant calling. As CallMolecularConsensusReads and FilterConsensusReads generated unmapped bam files, converting bam files to fastq files, the mapping and merging steps were repeated for the variant calling in the following step. The overall pipeline is shown in Fig. 1.