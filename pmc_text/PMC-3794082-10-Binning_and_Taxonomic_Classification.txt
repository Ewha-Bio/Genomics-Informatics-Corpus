Taxonomic classification of reads, which is called binning, is the most basic step in the characterization of microbial communities by metagenome sequencing. However, taxonomic binning of metagenome shotgun sequences is a challenging task for researchers, especially when working with short reads derived from NGS. There are several reasons that make binning a nontrivial job.
One of the reasons is that NGS technologies generally produce short reads. When applying shotgun sequencing to complex microbial communities found in soil, seawater, freshwater, and the gastrointestinal tract, the sequencing coverage does not reach the level required to make the assembly practically useful, even by current deep sequencing methods. The majority of reads remains unassembled. As a result, the majority of reads is taxonomically classified by the information in their short length. Short length presents a number of drawbacks in binning. Homology search-based methods suffer from a lack of alignment confidence and difficulties in predicting protein sequences from partial genes. Phylogenetic methods suffer from a lack of resolution due to insufficient phylogenetic information. Another challenge is the size of data that have to be processed during the binning process. Data size here refers to both the reads obtained from metagenomes and the sequences in the reference database. The novelty of microbes in the environmental samples also hampers binning, as they are not represented by any sequence in the reference database. One last challenging thing for researchers is the diversity of binning tools. There are dozens of choices, differing in both logical and practical aspects.
A straightforward approach for taxonomic classification of metagenome shotgun reads is searching for a similar sequence in a collection of known sequences that carries the taxonomic identity of each sequence. Similarity-based methods vary in at least three dimensions. 1) Choice of reference database: the search space could be restricted to a particular marker gene (e.g., SSU rRNA for prokaryotes) or a small number of selected protein families or could be as general as the entire NCBI nr database. 2) Search algorithm: from BLASTN (in case of using rRNA gene marker), BLASTX (protein database), and BLASTP (protein database after gene prediction) to a hidden Markov model (HMM)-based homology search (searching for protein families). 3) Taxonomic assignment from the hit information: from simply transferring the identity of the best hit to the use of LCA, modified LCA, or more complicated phylogenetic inferences. Among the popularly used tools, MEGAN uses the NCBI nr database for searching and LCA algorithms for assignment [29]. MTR and SOrt-ITEMS modified MEGAN's LCA algorithm by use of taxonomic information shared by hits (MTR) or by performing a reciprocal BLAST hit to reduce false positive hits (SOrt-ITEMS) [63, 64]. MG-RAST exploits both rRNA gene sequences and protein-coding sequences [65]. For the rRNA gene sequences, MG-RAST follows the RDP pipeline [22], while for protein-coding genes, it first predicts the protein coding sequences and then performs a BLASTX search against a number of databases, including SEED [66], and extracts taxonomic information from SEED hits. CARMA uses an algorithm similar to LCA and offers two ways for searching the database of known protein sequences: the NCBI nr database searched by BLASTX and the Pfam database searched by HMMER3 [67]. MetaPhyler is a power-up version of AMPHORA and uses 31 marker genes to reduce the search space [68, 69].
Composition-based classification of DNA sequences has been proven to be very useful, although it does not appear as intuitive as similarity-based methods. Composition-based methods exploit the uniqueness of base composition (from single to oligonucleotide levels) found across the genomes of different taxonomic entities. In many cases, these methods implement machine-learning algorithms. Ultimately, all of these methods use the taxonomic information of the reference database to assign a taxonomic identity to the reads. However, they can be divided into supervised and unsupervised methods, based on their dependence on the reference training set during the initial learning procedure. The most popular tools using supervised learning are PhyloPythia, NBC, and Phymm. Starting from the publicly available microbial genome sequences, NBC trains a na√Øve Bayes classifier based on the N-mer frequency profiles of each genome [70], Phymm builds an interpolated Markov Model using variable-length oligonucleotides typically found in taxa [71], and PhyloPythia trains a support vector machine classifier based on variable-length oligonucleotide composition [72]. Among the above, NBC and Phymm are suitable for classifying short reads generated from NGS sequencers. The popular tools employing unsupervised learning are TACOA and TaxSOM. TACOA introduced a kernelized k-nearest neighbor approach to cluster the reads [73], while TaxSOM uses batch-learning self-organizing maps (BLSOMs) and growing SOMs (GSOMs) to generate the clusters of related reads [74]. Both TaxSOM and TACOA are not suitable for unassembled short NGS reads.
There are tools that combine composition-based approaches and similarity-based approaches together to gain accuracy and discard fewer reads. PhymmBL linearly combines the BLASTN score and Phymm score and thereby gains more power to discriminate between similar BLAST hits [71]. RITA also combines a BLAST search with a composition-based NBC; however, unlike PhymmBL, RITA puts more weight on the BLAST result [75]. Both approaches are reported to perform well, even with short reads, but as they involve a BLAST search, they consume much time. There is a third type of taxonomic binning method recently implemented in the tool MetaPhlAn, which uses clade-specific marker genes [76]. From the database of microbial genomes, MetaPhlAn precalculated 400,141 genes that are most representative of each taxonomic unit. In theory, detection of the reads that match these markers can classify the members at the species level. MetaPhlAn uses BLASTN search to compare the reads against the set of marker genes. As the search space is markedly reduced from general sequence databases used in other approaches, MetaPhlAn exhibits unusually high speed.