Finding Interesting Genes Using Reliability in Various Gene Expression Models.

 Most statistical methods for finding interesting genes are focusing on the summary values with large foldchanges or large variations. Very few methods consider the probe level data. We developed a new measure to detect reliability that incorporates the probe level data. This reliability measure is useful for exploring the microarray data without ignoring the probe level data. It is easy to calculate, and it can be used for all the other statistical methods as a good guideline to find real differentially expressed genes. Instead of filtering out genes before the analysis, we use whole genes in the analysis and make decisions with new reliability measures. Keywords: microarray, quality control, reliability, probe level analysis, AffymetrixIn Affymetrix microarrays, the expression of each gene is measured by comparing the hybridization of the sample mRNA to a set of probes. A probe is composed of 11-20 pairs of oligonucleotides, each 25 base pairs in length. The first type of probe in each pair is known as a perfect match (PM), which is taken from the target gene sequence. The second type is known as a mismatch (MM), created by changing the middle (13th) base of the PM sequence. The purpose of measuring MM values is to control for nonspecific binding of mRNA, but the actual use of MM values has become controversial (Lazaridis et al., 2001). A gene expression experiment is usually conducted with multiple arrays, also called chips, to compare gene expression across different treatments (genotype, cofactor, replicate). Each chip is prepared by labeling it with a fluorescent dye and hybridizing it to an array. The arrays are scanned into images, which are numerically processed to obtain fluorescence intensity values for each PM and MM sequence. Gene expression microarrays are powerful bioinformatic tools, but the variability arising throughout the measurement process can obscure the biological signals of interest. Quantification of the measurement error helps to extract significant biological signals. The chiptochip variability is controlled by normalization, which yields the same distribution of PM and MM values for each chip. (See Bolstad et al., (2003) for a comparison of methods.) After normalization, the values from a probe set are summarized into a single gene expression measure, quantifying the gene activity. Common approaches are the average difference, the modelbased expression index (Li and Wong, 2001), the MAS 5.0 algorithm from Affymetrix, and the robust multichip average (rma) (Irizarry et al., 2003). Fig. 1 shows profile plots for two genes, 265670_s_a and 249093_at, each having 11 PM values. The rma summary expression value is a solid line, and the PM values are dashed lines. The horizontal axis shows the numbers for the eight chips, organized into three genotypes (A, B, C) and their replicates, and the vertical axis shows the logscale expression values. The gene 265670_s_a has much less variability in PM value than the gene 249093_at, and thus, it is considered to have a more reliable measure of gene expression. Commonly used models for finding differentially expressed genes are ANOVA (Churchill, 2004) and the HLM for oneway ANOVA (Chu et al., 2002). These models compare the expression values across experimental treatments for each gene. Genes that have differential expression on different treatments, relative to its variance over all chips, will have a low pvalue. Both of these methods use the summary expression value. In practice, with our data we have found that they also yield somewhat unsatisfactory results. Many genes on the resulting lists have relatively flat, uninteresting profiles, and yet, many genes filtered from the list have relatively structured, interesting profiles. This has motivated us to consider using the PM value in addition to the summary expression value to evaluate the significance of genes. Table 1 and Table 2 show ANOVA results for two sample genes, 265670_s_at and 249093_at. The pval 　 ues for both genes are very small, less than 107, suggesting that both genes have significantly different expression between treatments. A closer look, however, is revealing. The gene 265670_s_at has a very large mean square treatment effect, 4.9763, and a small mean square error, resulting in a high F value and low p-value. In contrast, the gene 249093_at has a small mean square treatment effect, 0.1653, and a very small mean square error effect, 0.0001, which also yields a high F value and low p-value. The profiles of these two genes are also plotted in Fig. 1. Although both genes are significant according to the ANOVA table, the genes are not alike. One gene has very flat profiles, which makes it less interesting than the other gene. The two genes have another difference. The profiles of the PM values are also shown in Fig. 1. The gene 249093_at has a lot more variability in PM values than 265670_s_at. The variability in the PM value should be incorporated into a model for detecting significant expression differences. Chu et al. (2002) proposed using the HLM for oneway ANOVA, which is a classical linear mixed model, incorporating probe-level data, for modeling expression. To fit the model, they use standard maximum likelihood (ML) methods using the Proc Mixed procedure in SAS and apply it for each gene. They also estimate the summary values from this model and use them for further analysis, like clustering. However, ML fitting for the model might be too sensitive to outliers. Fig. 2 shows the difference between RMA summary values and summary values from the HLM model for two genes, 265670_s_at (■) and 249093_at (○). For 265670_s_at, the estimated values from the HLM model are similar to the RMA summary values. However, the gene 249093_at, which has more varied PM values, shows quite different estimated values from the HLM model compared to the RMA summary values. This is due to the variation in the PM values. In this paper, we define the reliability of a summary gene expression value using the variation of probelevel data and show how to use this reliability measure with models for gene expression analysis and associated variance modifications, such as SAM (Tusher et al., 2001) and eBayes (Smyth, 2004). Reliability quantifies the uncertainty in gene expression measurements that can assist in filtering out genes with too much variability in favor of genes that have consistent measurements and significant expression. We start from the 2-level hierarchical linear model (HLM) for one gene. Let be Plk the log2-transformed probe level intensity value of the l-th chip and the kth oligonucleotide probe, l =1, 2, …, L, and k =1, 2,…, K (usually between 11-20). The chip-to-chip variability is usually controlled by normalizing the log2-transformed probe intensity values using the quantile method. Then, the probe level model is where Ml represents the summary expression value of the l-th chip and γlk is the normally distributed random error with a mean of 0 and a probe level variance σ2. We assume the common probe level variance for each chip. Because we do not know the true value for Ml, we set the level-2 (summary value level) model as follows: where μ is the overall mean, and εl is the random effect associated with the l-th chip, assumed to be normally distributed with a mean of 0 and a variance τ2. We assume that εl and γlk are independent. Combining (1) and (2) yields the model which is a oneway ANOVA model with a random effect, where μ is the overall mean, εl is a summary value level random effect, and γlk is a probe level random effect. Then, the variance of log2 probe intensities is The σ2 parameter represents the probe level variability, and τ2 captures the variability of the summary values. Most models for finding significant genes start from the summary value level model, using the summary values and ignoring the probe level variability. Our interest focuses not only on τ2 but also on σ2. If σ2 is large relative to τ2, the summary values of the chips might be less reliable. In the 2level HLM, the reliability ρ of the estimated value l is defined as follows (Raudenbush and Bryk, 2002): where τ2 represents the variation of the summary value Ml, and σ2 represents the variation of log2 probe intensity values PMlm. Therefore, this reliability can be written as: This measure is defined from the structure of HLM and represents the reliability of the summary expression values of the specific gene. This population version of the reliability is usually estimated by fitting the hierarchical model, where a simple mean of the log2transformed probe intensity values is used as the summary value. However, a simple mean of the log2 probe intensities is rarely used for the summary value in microarray data analysis. There are a lot of methods to calculate summary values in robust way (Bolstad et al., 2003), including RMA. Recently, (Millenaar et al., 2003) compared several calculation methods for summary values. They concluded that the user needs to try several different methods. However, it is usually not easy. We extend the approach by estimating reliability for any type of summary value method. Let yl be a summary value of the lth chip, and Pl1, Pl2, …, PlK are probelevel data. yl is calculated from Pl1, Pl2, …, PlK using one of the summarization methods. Then, our new reliability measure is defined as follows: This new reliability measure can be calculated easily with several different summary expression values. If RMA is the summary estimation method, yl is a summary value from RMA (Irizarry et al., 2003) and Pl1, Pl2, …, PlK are log2 PM values. If MBEI (Li and Wong, 2001) values are used, yl is a summary value from the dchip method and Pl1, Pl2, …, PlK are log2 PM log2 MM values. This new reliability statistic, ρ*, is easy to calculate, and it can be applied for a variety of summary value methods. The population version of reliability ρ in the equation (6) is only for the 2-level HLM model and can only be used for l. On the other hand, the reliability statistic ρ* can be used for diagnostics in models with various summary values. Therefore, it is possible to compare various methods to calculate summary values using this measure. There is no general rule to decide whether the reliability is high or not. We suggest a guideline that helps in decision-making. The definition of ρ* can be restated as follows: where K is a constant. Fig. 3 shows the relationship between ρ* and this ratio of variances. If the ratio is less than or equal to 1, the reliability ρ* will be larger than 0.92. If we allow this ratio up to 2, ρ* should be larger than 0.85. Therefore, if the ratio of variances between probelevel data and summary values is less than or equal to 1, we expect to have a reliability greater than 0.92. If the reliability is less than 0.92, in this case, we can not believe the result from the ANOVA. The experiment is a completely randomized design, containing one treatment having 3 levels A, B, C and each is replicated. The data were recorded on the new Affymetrix GeneChip Arabidopsis Genome Array. The PM values were normalized using the quantile method, and RMA was used to determine the summary expression value. We compare the gene lists resulting from the eBayes (Smyth, 2004) and SAM (Tusher et al., 2001) methods, classical ANOVA, and HLM for oneway ANOVA, along with reliability. Table 3 shows the results ordered by the top 15 genes from classical ANOVA. Table 4 shows the results ordered by eBayes. The tables display the ranks of the genes on the list according to the different methods. Table 5 lists genes that have good reliability and small pvalues that are unfortunately prone to being filtered off a list of interesting genes. Table 6 lists genes that have a small pvalue but also poor reliability that perhaps should be filtered off a list of interesting genes. By classical ANOVA (Table 3), the most significantly differentially expressed gene, 246785_at, is ranked as low as 129 by eBayes, 26 in the SAM method, and 985 by HLM, and the reliability of this gene is less than perfect at 0.846. The methods disagree on the significance of this gene. The second-ranked gene, 262128_at, has a good reliability (0.993) and is ranked highly by eBayes, SAM, and HLM; so, the methods all agree that this is an interesting gene. Fig. 4 shows the profiles of PM values for these genes. The difference in variability of the PM values supports the position that 262128_at is undoubtedly an interesting gene but that 246785_at is much less so. The worst genes on this list (Table 3) are 262605_at and 265575_at, with reliabilities of 0.166 and 0.624, respectively. Fig. 5 shows the profiles of PM values for these genes. There is a lot of variability in the PM values. Although they are at the top of the ANOVA model's list of significant genes, they should not be on a final list of interesting genes. Table 4 shows that there is considerable agreement about genes between eBayes and SAM. Both methods adjust their test statistics by shrinking an individual gene's variance estimate towards the variance of all genes. All of the differentially expressed genes on this list also have high reliability. The HLM disagrees with eBayes and SAM about the interestingness of several of the genes. A comparison of all of the genes is possible using brushing in a scatterplot matrix (Becker and Cleveland, 1988). Fig. 6 is the screenshot of the brushing being done with GGobi (Swayne et al., 2003). The scatterplot matrix has 5 diagnostic statistics: reliability, eBayes F values, ANOVA F values, SAM F values, and HLM χ2 values. (Large test statistics, F, χ2 correspond to small pvalues.) Each point in this plot represents one gene, with its corresponding values on the diagnostics plotted against the appropriate axis. The diagonal elements are density plots of each diagnostic. The eBayes, ANOVA, SAM, and HLM test statistics are all strongly leftskewed, which says that there are a lot more small values of these statistics and few high (important) values. Reliability has an unusual distribution fewer genes have high or low reliability and many more genes are in the midrange of the scale. The offdiagonal plots in the scatterplot matrix are the (5* 4/2=10) pairwise plots of the 5 diagnostics, which shows how the statistics are related to each other. The values for eBayes and SAM are very strongly related, with a slight nonlinear relationship. eBayes and SAM have a reasonably close association with ANOVA, with the exception of a relatively small number of the genes. eBayes and SAM have a moderate association with HLM for most genes, the HLM value seems to be the same as the eBayes or SAM value plus a constant. ANOVA has almost no relationship with HLM. Reliability has a much different relationship with each of the other diagnostics. Reliability and eBayes have the strongest association, where genes with high test statistic values also generally have high reliability. Many genes with high reliability have low test statistic values. This association is similar for SAM and HLM but not so for ANOVA; there are several genes that have high ANOVA test statistics but relatively low reliability. Brushing on the scatterplot matrix is done in the density plot of reliability. Genes with the highest reliability are brushed (red). These same genes are colored (red) in the other plots. The values that these genes have on the other diagnostics is interesting; they cover the full range of F statistic values for eBayes, SAM, and ANOVA but moderate to high values of χ2 for HLM. HLM uses the PM values, on which reliability is calculated, in the model, while the methods do not; so, there should be some similarity between the diagnostic values. That there are some differences must be due to the use of non-robust estimates of the summary values. Comparing eBayes and ANOVA, the high-reliability genes have a very strong relationship, and there are many genes rated highly by ANOVA that have low reliability. The most interesting feature of the diagnostics revealed by the scatterplot matrix is that there are three outliers, which are the three genes that eBayes, SAM, and HLM all rate very highly: 262128_at, 251428_at, and 254098_at. There is also an outlier in the values of ANOVA, which have low reliability, and this corresponds to the gene that ANOVA rates very highly, counter to all of the other diagnostics: 246785_at. We also see several other outliers in the ANOVA and Reliability plot that have low reliability, two of which correspond to 265575_at and 262605_at (Fig. 7). From this analysis, it looks like eBayes, SAM, and HLM all do a reasonable job in finding significantly differentially expressed genes. However, they can miss a few genes that perhaps should be detected, and they can also accept a few genes that perhaps should not be detected. Reliability helps to uncover these. Table 5 lists 5 genes that have high reliability (＞0.9) and relatively high ranks (＜1,000). But, they also have small foldchanges that might exclude them if filtering is conducted before the analysis. Profiles for two of these genes are shown in Fig. 8. These genes are characterized by small differences in the summary expression values for each treatment but also by very consistent PM values. Based on the PM values, to which eBayes and SAM are blind, it could very well be argued that these are significantly differentially expressed genes. Table 6 lists 5 genes that have very low reliability (＜0.65) and relatively high ranks (＜1,000). They would be included in the significantly differently expressed genes, but the reliability of these genes is very low, casting doubt on the interestingness of these genes. Based on the PM values, to which eBayes and SAM are blind, it could very well be argued that they are not significantly differentially expressed genes. In this paper, we defined a new reliability statistic that can be used with any other statistical method to find differentially expressed genes. This measure is very easy to calculate, relative to applying the eBayes and SAM methods. Therefore, it can be used easily for the exploratory data analysis step as well as the intensive data analysis step. It also provides a guide to the variance of each gene's summary expression value. This statistic can also be used with the other statistical methods, like clustering and classification. The R package ProbeR for calculating and exploring reliability measure with GGobi is available at CRAN (http://www.r-project. org).